(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54ca68fc"],{a36c:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:48}},[a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"资源名称"}},[a("a-input",{attrs:{placeholder:"资源名称"},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),a("a-col",{attrs:{md:8,sm:24}},[a("a-form-item",{attrs:{label:"类型"}},[a("a-select",{attrs:{placeholder:"请选择","default-value":"ROUTE"},model:{value:e.queryParam.type,callback:function(t){e.$set(e.queryParam,"type",t)},expression:"queryParam.type"}},[a("a-select-option",{attrs:{value:"MENU"}},[e._v("菜单")]),a("a-select-option",{attrs:{value:"API"}},[e._v("接口")]),a("a-select-option",{attrs:{value:"BUTTON"}},[e._v("按钮")])],1)],1)],1),a("a-col",{attrs:{md:e.advanced?24:8,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons",style:e.advanced&&{float:"right",overflow:"hidden"}||{}},[a("a-button",{attrs:{type:"primary"},on:{click:e.loadData}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(){return e.queryParam={}}}},[e._v("重置")]),a("a",{staticStyle:{"margin-left":"8px"},on:{click:e.toggleAdvanced}},[e._v(" "+e._s(e.advanced?"收起":"展开")+" "),a("a-icon",{attrs:{type:e.advanced?"up":"down"}})],1)],1)])],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.handleAdd()}}},[e._v("新建")])],1),a("a-table",{attrs:{columns:e.columns,"data-source":e.treeData,loading:e.treeDataLoading,rowKey:"id"},scopedSlots:e._u([{key:"action",fn:function(t,o){return a("span",{},[[a("a",{on:{click:function(t){return e.handleEdit(o)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"确认删除这条数据？","ok-text":"确认",okType:"danger","cancel-text":"取消",placement:"left"},on:{confirm:function(t){return e.handleDelete(o)}}},[a("a-icon",{staticStyle:{color:"red"},attrs:{slot:"icon",type:"question-circle-o"},slot:"icon"}),a("a",{staticStyle:{color:"#ff4d4f"}},[e._v("删除")])],1)]],2)}}])}),a("create-form",{ref:"createModal",attrs:{visible:e.visible,loading:e.confirmLoading,resources:e.resources,model:e.mdl},on:{cancel:e.handleCancel,ok:e.handleOk}})],1)},n=[],r=(a("4de4"),a("a15b"),a("ac1f"),a("1276"),a("5530")),i=a("c1df"),l=a.n(i),s=a("2af9"),d=a("a498"),c=a("ca00"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:e.model&&e.model.id?"修改":"新增",width:640,visible:e.visible,confirmLoading:e.loading},on:{ok:function(){e.$emit("ok")},cancel:function(){e.$emit("cancel")}}},[a("a-spin",{attrs:{spinning:e.loading}},[a("a-form-model",e._b({ref:"form",attrs:{model:e.model,rules:e.rules}},"a-form-model",e.formLayout,!1),[e.model.id?a("a-form-model-item",{attrs:{label:"ID",prop:"id"}},[a("a-input",{attrs:{disabled:""},model:{value:e.model.id,callback:function(t){e.$set(e.model,"id",t)},expression:"model.id"}})],1):e._e(),a("a-form-model-item",{attrs:{label:"资源类型",prop:"type"}},[a("a-radio-group",{model:{value:e.model.type,callback:function(t){e.$set(e.model,"type",t)},expression:"model.type"}},[a("a-radio",{attrs:{value:"MENU"}},[e._v(" 菜单 ")]),a("a-radio",{attrs:{value:"API"}},[e._v(" API ")]),a("a-radio",{attrs:{value:"BUTTON"}},[e._v(" 按钮 ")])],1)],1),"API"===e.model.type?a("a-form-model-item",{attrs:{label:"请求类型",prop:"methodList"}},[a("a-checkbox-group",{attrs:{options:e.methodOptions},model:{value:e.model.methodList,callback:function(t){e.$set(e.model,"methodList",t)},expression:"model.methodList"}})],1):e._e(),"MENU"===e.model.type?a("a-form-model-item",{attrs:{label:"父级id",prop:"parentId"}},[a("a-tree-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.treeData,replaceFields:e.treeFields,placeholder:"选择上级目录","allow-clear":"","tree-default-expand-all":""},model:{value:e.model.parentId,callback:function(t){e.$set(e.model,"parentId",t)},expression:"model.parentId"}})],1):e._e(),a("a-form-model-item",{attrs:{label:"MENU"===e.model.type?"菜单名称":"API"===e.model.type?"接口名称":"按钮名称",prop:"name"}},[a("a-input",{model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),"BUTTON"!==e.model.type?a("a-form-model-item",{attrs:{label:"地址",prop:"uri"}},[a("a-input",{attrs:{placeholder:"API"===e.model.type?"接口地址":"页面访问地址"},model:{value:e.model.uri,callback:function(t){e.$set(e.model,"uri",t)},expression:"model.uri"}})],1):e._e(),a("a-form-model-item",{attrs:{label:"排序",prop:"sort"}},[a("a-input",{model:{value:e.model.sort,callback:function(t){e.$set(e.model,"sort",t)},expression:"model.sort"}})],1),"API"!==e.model.type?a("a-form-model-item",{attrs:{label:"图标",prop:"icon"}},[a("icon-selector",{on:{change:e.handleIconChange},model:{value:e.model.icon,callback:function(t){e.$set(e.model,"icon",t)},expression:"model.icon"}})],1):e._e()],1)],1)],1)},u=[],p=(a("4160"),a("159b"),a("98a7"),a("7bec")),f=a("13bb"),h=["GET","POST","PUT","DELETE"],b={components:{TreeSelect:p["a"],IconSelector:f["a"]},props:{visible:{type:Boolean,required:!0},loading:{type:Boolean,default:function(){return!1}},resources:{type:Array,default:function(){return[]}},model:{type:Object,default:function(){return{type:"API"}}}},data:function(){return this.formLayout={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:13}}},{form:this.$form.createForm(this),resourceList:[],treeData:[],treeFields:{key:"id",title:"name",value:"id"},selectedIcon:null,rules:{name:[{required:!0,message:"请输入至少2个字符的名称！",trigger:"change"}],uri:[{required:!0,min:2,message:"请输入至少2个字符的名称！",trigger:"change"}],type:[{required:!0,message:"请选择类型！"}],methodList:[{required:!0,message:"请选择请求方式！"}],parentId:[{required:!0,message:"请选择上级！"}],icon:[{required:!0,message:"请选择ICON！"}]},methodOptions:h}},created:function(){},methods:{loadTreeData:function(){this.treeData=[{id:-1,name:"根目录"}],this.listToTree(this.resources,this.treeData,-1)},listToTree:function(e,t,a){var o=this;e.forEach((function(n){if(n.parentId===a){var i=Object(r["a"])(Object(r["a"])({},n),{},{children:[]});o.listToTree(e,i.children,n.id),i.children.length<=0&&delete i.children,t.push(i)}}))},handleIconChange:function(e){this.model.icon=e}},watch:{"model.type":function(e,t){},resources:function(e,t){this.loadTreeData()},deep:!0}},v=b,g=a("2877"),y=Object(g["a"])(v,m,u,!1,null,null,null),L=y.exports,k={name:"ResourceList",components:{STable:s["b"],CreateForm:L},data:function(){return{visible:!1,confirmLoading:!1,mdl:{},advanced:!1,queryParam:{},columns:[{title:"名称",dataIndex:"name"},{title:"地址",dataIndex:"uri"},{title:"资源类型",dataIndex:"type"},{title:"操作",dataIndex:"action",width:"150px",scopedSlots:{customRender:"action"}}],treeData:null,treeDataLoading:!1,menuList:[],resources:[]}},created:function(){this.loadData()},methods:{loadData:function(){var e=this;this.treeDataLoading=!0,Object(d["c"])(Object.assign({},this.queryParam)).then((function(t){e.menuList=t.data.filter((function(e){return"MENU"===e.type})),e.resources=e.menuList;var a=[];Object(c["a"])(t.data,a,-1),e.treeData=a,e.treeDataLoading=!1}))},handleAdd:function(){this.mdl={type:"API",methodList:[]},this.visible=!0},handleEdit:function(e){this.visible=!0,this.resources=this.menuList.filter((function(t){return t.id!==e.id})),e.methodList=e.methods.split(";"),this.mdl=Object(r["a"])({},e)},handleOk:function(){var e=this,t=this.$refs.createModal.$refs.form;this.confirmLoading=!0,t.validate((function(a){if(!a)return e.confirmLoading=!1,!1;e.mdl.methodList&&(e.mdl.methods=e.mdl.methodList.join(";")),e.mdl.id?Object(d["d"])(e.mdl).then((function(a){e.visible=!1,e.confirmLoading=!1,t.resetFields(),e.loadData(),e.$message.info("修改成功")})).catch((function(t){e.confirmLoading=!1})):Object(d["a"])(e.mdl).then((function(a){e.visible=!1,e.confirmLoading=!1,t.resetFields(),e.loadData(),e.$message.info("新增成功")})).catch((function(t){e.confirmLoading=!1}))}))},toggleAdvanced:function(){this.advanced=!this.advanced},handleCancel:function(){this.visible=!1;var e=this.$refs.createModal.$refs.form;e.resetFields()},handleDelete:function(e){var t=this;Object(d["b"])(e.id).then((function(e){t.$message.info("删除成功"),t.loadData()}))},resetSearchForm:function(){this.queryParam={date:l()(new Date)}}}},x=k,D=Object(g["a"])(x,o,n,!1,null,null,null);t["default"]=D.exports},a498:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return s}));a("99af");var o=a("b775"),n={PageInfo:"/api/resource/page",Route:"/api/resource/routes",Update:"/api/resource",AllList:"/api/resource/list",Delete:"/api/resource"};function r(e){return Object(o["b"])({url:n.AllList,method:"get",params:e})}function i(e){return Object(o["b"])({url:n.Update,method:"post",data:e})}function l(e){return Object(o["b"])({url:n.Update,method:"put",data:e})}function s(e){return Object(o["b"])({url:"".concat(n.Delete,"/").concat(e),method:"delete"})}}}]);